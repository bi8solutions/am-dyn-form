<ng-container [ngSwitch]="dfc.type">
  <div fxLayout="row" class="am-field-row">
    <!--=====[ AUTO SELECT FIELD ]=====-->
    <ng-container *ngSwitchCase="'autoselect'">
      <div class="am-field-container" fxLayout="row" fxFlex>
        <ng-select [items]="dfc.items$ | async"
                   [formControl]="dfc"
                   [placeholder]="dfc.getCustomPlaceholder()"
                   [bindLabel]="dfc.bindLabel"
                   [typeahead]="dfc.typeahead$"
                   [loading]="dfc.loading"
                   [bindValue]="dfc.bindValue"
                   [multiple]="dfc.multiple"
                   [searchable]="dfc.searchable"
                   fxFlex="1 1 auto"
                   [ngClass]="{'am-has-value': dfc.hasValue, 'am-no-value' : !dfc.hasValue}"
                   style="width: 100px;">
          <ng-template ng-label-tmp let-item="item" *ngIf="dfc.labelTemplate">
            <ng-container [ngTemplateOutlet]="dfc.labelTemplate" [ngTemplateOutletContext]="{item: item}"></ng-container>
          </ng-template>

          <ng-template ng-option-tmp let-item="item" let-index="index" let-search="searchTerm" *ngIf="dfc.optionTemplate">
            <ng-container [ngTemplateOutlet]="dfc.optionTemplate" [ngTemplateOutletContext]="{item: item, index: index, search: search}"></ng-container>
          </ng-template>
        </ng-select>
        <span class="am-select-error" *ngIf="dfc.hasError('required') && dfc.touched">{{resolveValidationMessage('required')}}</span>
        <span class="am-select-error" *ngIf="dfc.hasError('pattern') && dfc.touched">{{resolveValidationMessage('pattern')}}</span>
        <span class="am-select-error" *ngIf="dfc.hasError('email') && dfc.touched">{{resolveValidationMessage('email')}}</span>
        <span class="am-select-error" *ngIf="dfc.hasError('match') && dfc.touched">{{resolveValidationMessage('match')}}</span>
        <span class="am-select-error" *ngIf="dfc.hasError('time') && dfc.touched">{{resolveValidationMessage('time')}}</span>
        <span class="am-select-error" *ngIf="dfc.hasError('logical') && dfc.touched">{{dfc.logicalErrorMessage}}</span>
      </div>
    </ng-container>

    <!--=====[ TEXT FIELD ]=====-->
    <mat-form-field *ngSwitchCase="'text'" [hintLabel]="hint" fxFlex>
      <input matInput
             hideRequiredMarker="false"
             [name]="dfc.key"
             [formControl]="dfc"
             [type]="dfc.config.format"
             [placeholder]="placeholder"
             [maxlength]="dfc.config.maxlimit"
             [required]="dfc.config.required"
             [dir]="dfc.config.dir">

      <mat-hint *ngIf="dfc.config.counter && dfc.config.maxlimit" align="end" class="no-text-wrap">{{dfc.value ? dfc.value.length : 0}} / {{dfc.config.maxlimit}}</mat-hint>

      <mat-error *ngIf="dfc.hasError('required')">{{resolveValidationMessage('required')}}</mat-error>
      <mat-error *ngIf="dfc.hasError('pattern')">{{resolveValidationMessage('pattern')}}</mat-error>
      <mat-error *ngIf="dfc.hasError('email')">{{resolveValidationMessage('email')}}</mat-error>
      <mat-error *ngIf="dfc.hasError('match')">{{resolveValidationMessage('match')}}</mat-error>
      <mat-error *ngIf="dfc.hasError('time')">{{resolveValidationMessage('time')}}</mat-error>
      <mat-error *ngIf="dfc.hasError('logical')">{{dfc.logicalErrorMessage}}</mat-error>
    </mat-form-field>

    <!--=====[ TEXTAREA FIELD ]=====-->
    <mat-form-field *ngSwitchCase="'textarea'" [hintLabel]="hint" fxFlex>
      <textarea matInput
                hideRequiredMarker="false"
                matTextareaAutosize
                [matAutosizeMinRows]="dfc.config.minRows"
                [matAutosizeMaxRows]="dfc.config.maxRows"
                [name]="dfc.key"
                [formControl]="dfc"
                [placeholder]="placeholder"
                [maxlength]="dfc.config.maxlimit"
                [required]="dfc.config.required"
                [dir]="dfc.config.dir"></textarea>

      <mat-hint *ngIf="dfc.config.counter && dfc.config.maxlimit" align="end" class="no-text-wrap">{{dfc.value ? dfc.value.length : 0}} / {{dfc.config.maxlimit}}</mat-hint>
      <mat-error *ngIf="dfc.hasError('required')">{{resolveValidationMessage('required')}}</mat-error>
      <mat-error *ngIf="dfc.hasError('pattern')">{{resolveValidationMessage('pattern')}}</mat-error>
      <mat-error *ngIf="dfc.hasError('email')">{{resolveValidationMessage('email')}}</mat-error>
      <mat-error *ngIf="dfc.hasError('match')">{{resolveValidationMessage('match')}}</mat-error>
      <mat-error *ngIf="dfc.hasError('logical')">{{dfc.logicalErrorMessage}}</mat-error>
    </mat-form-field>

    <!--=====[ AUTOCOMPLETE ]=====-->
    <ng-container *ngSwitchCase="'auto-complete'">
      <mat-form-field fxFlex>
        <input matInput
               [name]="dfc.key"
               [placeholder]="placeholder"
               [matAutocomplete]="auto"
               [formControl]="dfc"
               [required]="dfc.config.required"
               [dir]="dfc.config.dir">

        <mat-error *ngIf="dfc.hasError('required')">{{resolveValidationMessage('required')}}</mat-error>
        <mat-error *ngIf="dfc.hasError('match')">{{resolveValidationMessage('match')}}</mat-error>
        <mat-error *ngIf="dfc.hasError('logical')">{{dfc.logicalErrorMessage}}</mat-error>

        <mat-autocomplete #auto="matAutocomplete" [displayWith]="dfc.displayFn.bind(dfc)">
          <mat-option *ngFor="let opt of dfc.selectOptions$ | async" [value]="opt">
            {{dfc.displayFn(opt)}}
          </mat-option>
        </mat-autocomplete>
      </mat-form-field>
    </ng-container>

    <!--=====[ DATE ]=====-->
    <ng-container *ngSwitchCase="'date'">
      <mat-form-field fxFlex>
        <input matInput
               hideRequiredMarker="false"
               [name]="dfc.key"
               [formControl]="dfc"
               type="text"
               [min]="dfc.minDate"
               [max]="dfc.maxDate"
               [required]="dfc.config.required"
               [matDatepicker]="picker"
               [placeholder]="placeholder"
               style="pointer-events:none;" />

        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
        <mat-datepicker #picker></mat-datepicker>

        <mat-error *ngIf="dfc.hasError('required')">{{resolveValidationMessage('required')}}</mat-error>
        <mat-error *ngIf="dfc.hasError('pattern')">{{resolveValidationMessage('pattern')}}</mat-error>
        <mat-error *ngIf="dfc.hasError('match')">{{resolveValidationMessage('match')}}</mat-error>
        <mat-error *ngIf="dfc.hasError('logical')">{{dfc.logicalErrorMessage}}</mat-error>
      </mat-form-field>
    </ng-container>

    <!--=====[ DATE ]=====-->
    <ng-container *ngSwitchCase="'time'">
      <am-timepicker [formControl]="dfc"></am-timepicker>
    </ng-container>

    <!--=====[ SELECT FIELD ]=====-->
    <ng-container *ngSwitchCase="'select'" >
      <mat-form-field fxFlex>
        <mat-select [formControl]="dfc"
                   [placeholder]="placeholder"
                   [required]="dfc.config.required"
                   required="true"
                   [multiple]="dfc.multiple">
          <mat-option *ngIf="dfc.showNone" (click)="dfc.reset()">{{dfc.noneLabel}}</mat-option>
          <mat-option *ngFor="let opt of dfc.selectOptions$ | async" [value]="opt.code">{{opt.value}}</mat-option>
        </mat-select>
        <mat-error *ngIf="dfc.hasError('required') && dfc.touched">This option is required</mat-error>
      </mat-form-field>
    </ng-container>

    <!--=====[ CHECK BOX ]=====-->
    <ng-container *ngSwitchCase="'checkbox'">
      <mat-checkbox [formControl]="dfc" fxFlex>
        {{placeholder}}
      </mat-checkbox>
    </ng-container>

    <!--=====[ LABEL ]=====-->
    <ng-container *ngSwitchCase="'label'">
      <div fxFlex>{{placeholder}}</div>
    </ng-container>
  </div>
</ng-container>
